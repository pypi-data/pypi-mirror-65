!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ganttChartD3v2=e():(t.Airflow=t.Airflow||{},t.Airflow.ganttChartD3v2=e())}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}({8:function(t,e){const n={a:"ddd",A:"dddd",b:"MMM",B:"MMMM",c:"lll",d:"DD","-d":"D",e:"D",F:"YYYY-MM-DD",H:"HH","-H":"H",I:"hh","-I":"h",j:"DDDD","-j":"DDD",k:"H",l:"h",m:"MM","-m":"M",M:"mm","-M":"m",p:"A",P:"a",S:"ss","-S":"s",u:"E",w:"d",W:"WW",x:"ll",X:"LTS",y:"YY",Y:"YYYY",z:"ZZ",Z:"z",f:"SSS","%":"%"};moment.fn.strftime=function(t){var e;return e=t.split(/(%\-?.)/).map(function(t){return"%"===t[0]&&n.hasOwnProperty(t.substr(1))?n[t.substr(1)]:t.length>0?"["+t+"]":t}).join(""),this.format(e)},d3.gantt=function(){var t=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){var e="";return e+="<div class='row'>",e+="<div class='col-md-3'>start:<br/>end:<br/>duration:<br/>try_number:</div>",e+="<div class='col-md-9'><span style='color: #AAA'> ",e+=t.isoStart+"<br/>",e+=t.isoEnd+"<br/>",e+=convertSecsToHumanReadable(t.duration)+"<br/>",e+=t.try_number+"<br/>",e+="</span></div>",e+="</div>"}),e={top:20,right:40,bottom:20,left:150},n=220,r="body",a=d3.time.day.offset(new Date,-3),o=d3.time.hour.offset(new Date,3),i="fit",s=[],u=[],c=document.body.clientHeight-e.top-e.bottom-5,l=$(".gantt").width()-e.right-e.left-5,d="%H:%M",f=function(t){return t.startDate+t.taskName+t.endDate},m=function(t){return"translate("+(p(t.startDate)+n)+","+g(t.taskName)+")"};function h(t){return moment(t).strftime(d)}var p=d3.time.scale().domain([a,o]).range([0,l-n]).clamp(!0),g=d3.scale.ordinal().domain(s).rangeRoundBands([0,c-e.top-e.bottom],.1),b=d3.svg.axis().scale(p).orient("bottom").tickFormat(h).tickSubdivide(!0).tickSize(8).tickPadding(8),D=d3.svg.axis().scale(g).orient("left").tickSize(0),v=function(t){if("fit"===i){if(void 0===t||t.length<1)return a=d3.time.day.offset(new Date,-3),void(o=d3.time.hour.offset(new Date,3));t.sort(function(t,e){return t.endDate-e.endDate}),o=t[t.length-1].endDate,t.sort(function(t,e){return t.startDate-e.startDate}),a=t[0].startDate}},y=function(){p=d3.time.scale().domain([a,o]).range([0,l-n]).clamp(!0),g=d3.scale.ordinal().domain(s).rangeRoundBands([0,c-e.top-e.bottom],.1),b=d3.svg.axis().scale(p).orient("bottom").tickFormat(h).tickSubdivide(!0).tickSize(8).tickPadding(8),D=d3.svg.axis().scale(g).orient("left").tickSize(0)};function x(a){v(a),y();var o=d3.select(r).append("svg").attr("class","chart").attr("width",l+e.left+e.right).attr("height",c+e.top+e.bottom).append("g").attr("class","gantt-chart").attr("width",l+e.left+e.right).attr("height",c+e.top+e.bottom).attr("transform","translate("+e.left+", "+e.top+")");return o.selectAll(".chart").data(a,f).enter().append("rect").on("mouseover",t.show).on("mouseout",t.hide).on("click",function(t){call_modal(t.taskName,t.executionDate,t.extraLinks)}).attr("class",function(t){return null==u[t.status]?"null":u[t.status]}).attr("y",0).attr("transform",m).attr("height",function(t){return g.rangeBand()}).attr("width",function(t){return d3.max([p(t.endDate)-p(t.startDate),1])}),o.append("g").attr("class","x axis").attr("transform","translate("+n+", "+(c-e.top-e.bottom)+")").transition().call(b),o.append("g").attr("class","y axis").transition().attr("transform","translate("+n+", 0)").call(D),o.call(t),x}return x.redraw=function(t){v(t),y();var e=d3.select(".chart"),n=e.select(".gantt-chart").selectAll("rect").data(t,f);return n.enter().insert("rect",":first-child").attr("rx",5).attr("ry",5).attr("class",function(t){return null==u[t.status]?"bar":u[t.status]}).transition().attr("y",0).attr("transform",m).attr("height",function(t){return g.rangeBand()}).attr("width",function(t){return d3.max([p(t.endDate)-p(t.startDate),1])}),n.exit().remove(),e.select(".x").transition().call(b),e.select(".y").transition().call(D),x},x.margin=function(t){return arguments.length?(e=t,x):e},x.timeDomain=function(t){return arguments.length?(a=+t[0],o=+t[1],x):[a,o]},x.timeDomainMode=function(t){return arguments.length?(i=t,x):i},x.taskTypes=function(t){return arguments.length?(s=t,x):s},x.taskStatus=function(t){return arguments.length?(u=t,x):u},x.width=function(t){return arguments.length?(l=+t,x):l},x.height=function(t){return arguments.length?(c=+t,x):c},x.tickFormat=function(t){return arguments.length?(d=t,x):d},x.selector=function(t){return arguments.length?(r=t,x):r},x}}})});