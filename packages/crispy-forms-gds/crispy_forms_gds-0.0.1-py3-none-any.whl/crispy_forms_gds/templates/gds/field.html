{% load crispy_forms_field crispy_forms_gds_field %}

{% if field.is_hidden %}
  {{ field }}
{% else %}
  {% if field|is_checkbox %}
    <div class="form-group">
    {% if label_class %}
      <div class="controls {% for offset in bootstrap_checkbox_offsets %}{{ offset }} {% endfor %}{{ field_class }}">
    {% endif %}
  {% endif %}

  <{% if tag %}{{ tag }}{% else %}div{% endif %} id="div_{{ field.auto_id }}" {% if not field|is_checkbox %}class="govuk-form-group {% if form_show_errors%}{% if field.errors %}govuk-form-group--error{% endif %}{% endif %}{% else %}class="checkbox{% endif %}{% if wrapper_class %} {{ wrapper_class }}{% endif %}{% if field.css_classes %} {{ field.css_classes }}{% endif %}">
    {% if field.label and not field|is_checkbox and form_show_labels %}
      <label for="{{ field.id_for_label }}" class="govuk-label">
        {{ field.label|safe }}
      </label>
    {% endif %}

    {% if field|is_checkboxselectmultiple %}
      {% include 'gds/layout/checkboxselectmultiple.html' %}
    {% endif %}

    {% if field|is_radioselect %}
      {% include 'gds/layout/radioselect.html' %}
    {% endif %}

    {% if not field|is_checkboxselectmultiple and not field|is_radioselect %}
      {% if field|is_checkbox and form_show_labels %}
        {% include 'gds/layout/help_text_and_errors.html' %}
        <label for="{{ field.id_for_label }}" class="govuk-label">
          {% crispy_gds_field field %}
          {{ field.label|safe }}
        </label>
      {% else %}
        {% include 'gds/layout/help_text_and_errors.html' %}
        {% crispy_gds_field field %}
      {% endif %}
    {% endif %}
  </{% if tag %}{{ tag }}{% else %}div{% endif %}>

  {% if field|is_checkbox %}
    {% if label_class %}
      </div>
    {% endif %}
    </div>
  {% endif %}
{% endif %}
