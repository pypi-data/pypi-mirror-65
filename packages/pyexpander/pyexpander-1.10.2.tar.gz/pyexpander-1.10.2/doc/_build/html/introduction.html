

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; pyexpander 1.10.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reference" href="reference-expander.html" />
    <link rel="prev" title="Welcome to pyexpander’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pyexpander
          

          
          </a>

          
            
            
              <div class="version">
                1.10.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#macro-substitution">Macro substitution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference-expander.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="reference-expander.html#a-note-on-python-versions">A note on Python versions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#short-version">Short version</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#background">Background</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reference-expander.html#syntax-of-the-pyexpander-language">Syntax of the pyexpander language</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#the-meaning-of-the-dollar-sign">The meaning of the dollar sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#comments">Comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#commands">Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#executing-python-statements">Executing python statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#line-continuation">Line continuation</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#substitutions">Substitutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#default-values-for-variables">Default values for variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#variable-scopes">Variable scopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#extending-the-pyexpander-language">Extending the pyexpander language</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#conditionals">Conditionals</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#while-loops">While loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#for-loops">For loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#macros">macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#include-files">Include files</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#safe-mode">Safe mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#commands-for-epics-macro-substitution">Commands for EPICS macro substitution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reference-expander.html#internals">Internals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#pyexpander-parser">pyexpander.parser</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#pyexpander-lib">pyexpander.lib</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reference-expander.html#scripts-provided-by-the-package">Scripts provided by the package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#expander-py">expander.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-expander.html#msi2pyexpander-py">msi2pyexpander.py</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="epics-support.html">EPICS support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="epics-support.html#setting-the-name-of-the-template-file">Setting the name of the template file</a></li>
<li class="toctree-l2"><a class="reference internal" href="epics-support.html#the-subst-command">The “subst” command</a></li>
<li class="toctree-l2"><a class="reference internal" href="epics-support.html#the-pattern-command">The “pattern” command</a></li>
<li class="toctree-l2"><a class="reference internal" href="epics-support.html#differences-to-the-epics-msi-tool">Differences to the EPICS msi tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python3.html">Useful Python 3 basics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="python3.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="python3.html#comments">Comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="python3.html#a-word-on-indentation">A word on indentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="python3.html#defining-variables">Defining variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="python3.html#literals">Literals</a></li>
<li class="toctree-l3"><a class="reference internal" href="python3.html#setting-more-than-one-variable">Setting more than one variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="python3.html#simple-expressions">Simple expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="python3.html#mathematical-functions">Mathematical functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="python3.html#string-expressions">String expressions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="python3.html#for-loops">For loops</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="expander-options.html">expander.py command line options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="expander-options.html#h"><code class="docutils literal notranslate"><span class="pre">-h</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expander-options.html#summary"><code class="docutils literal notranslate"><span class="pre">--summary</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expander-options.html#f-file-file-file"><code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">FILE</span> <span class="pre">--file</span> <span class="pre">FILE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expander-options.html#encoding"><code class="docutils literal notranslate"><span class="pre">--encoding</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expander-options.html#output-encoding"><code class="docutils literal notranslate"><span class="pre">--output-encoding</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expander-options.html#eval"><code class="docutils literal notranslate"><span class="pre">--eval</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expander-options.html#i-path-include-path"><code class="docutils literal notranslate"><span class="pre">-I</span> <span class="pre">PATH</span> <span class="pre">--include</span> <span class="pre">PATH</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expander-options.html#s-simple-vars"><code class="docutils literal notranslate"><span class="pre">-s</span> <span class="pre">--simple-vars</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expander-options.html#a-auto-continuation"><code class="docutils literal notranslate"><span class="pre">-a</span> <span class="pre">--auto-continuation</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expander-options.html#i-auto-indent"><code class="docutils literal notranslate"><span class="pre">-i</span> <span class="pre">--auto-indent</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expander-options.html#no-stdin-msg"><code class="docutils literal notranslate"><span class="pre">--no-stdin-msg</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="msi2pyexpander-options.html">msi2pyexpander.py command line options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="msi2pyexpander-options.html#h"><code class="docutils literal notranslate"><span class="pre">-h</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="msi2pyexpander-options.html#summary"><code class="docutils literal notranslate"><span class="pre">--summary</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="msi2pyexpander-options.html#s-substitutionfile"><code class="docutils literal notranslate"><span class="pre">-S</span> <span class="pre">--substitutionfile</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="msi2pyexpander-options.html#o-file-outputfile-file"><code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">FILE</span> <span class="pre">--outputfile</span> <span class="pre">FILE</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyexpander-install.html">Installing pyexpander</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyexpander-install.html#parts-of-pyexpander">Parts of pyexpander</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyexpander-install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyexpander-install.html#install-from-pypi-with-pip">Install from pypi with pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyexpander-install.html#install-from-a-debian-package">Install from a debian package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyexpander-install.html#install-from-a-rpm-package">Install from a rpm package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyexpander-install.html#install-from-source-with-setup-py">Install from source with setup.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyexpander-install.html#install-as-root-to-default-directories">Install as root to default directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyexpander-install.html#install-to-a-separate-directory">Install to a separate directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyexpander-install.html#install-in-your-home">Install in your home</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="source-code-documentation.html">Source code documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="source-code-documentation.html#module-pyexpander.lib">pyexpander.lib module</a></li>
<li class="toctree-l2"><a class="reference internal" href="source-code-documentation.html#module-pyexpander.parser">pyexpander.parser module</a></li>
<li class="toctree-l2"><a class="reference internal" href="source-code-documentation.html#module-expander">expander script</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">Pyexpander License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyexpander</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/introduction.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="macro-substitution">
<h2>Macro substitution<a class="headerlink" href="#macro-substitution" title="Permalink to this headline">¶</a></h2>
<p>Note: The examples below use “expander.py”, the python 3 implementation of
pyexpander. You have to call “expander2.py” if you installed the python 2
implementation of pyexpander. Note that python 2 is deprecated, it will not be
supported in future versions.</p>
<p>For some projects there is the need to replace macros in a text file with
values defined in other files or the command line. There are already other
macro replacement tools that can do this but if you want to calculations or
string operations and insert the results of this into your file, the list of
possible tools becomes much shorter.</p>
<p>Pyexpander combines the python programming language with a simple macro
replacement scheme in order to give the user both, ease of use and the
power of a full featured scripting language.</p>
<p>Even without being familiar with python you can use pyexpander to perform
calculations or string operations and use the results in your macro
replacements.</p>
<p>Here is a very simple example, this is the content of file “letter.txt”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Dear $(salutation) $(surname),

this is a simple pyexpander example.
</pre></div>
</div>
<p>Applying this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">expander</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="nb">eval</span> <span class="s1">&#39;salutation=&quot;Mr&quot;;surname=&quot;Smith&quot;&#39;</span> <span class="o">-</span><span class="n">f</span> <span class="n">letter</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>gives this result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dear</span> <span class="n">Mr</span> <span class="n">Smith</span><span class="p">,</span>

<span class="n">this</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">simple</span> <span class="n">pyexpander</span> <span class="n">example</span><span class="o">.</span>
</pre></div>
</div>
<p>Here is more advanced example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$py(start=0; end=5)\
 x |  x**2
---|------
$for(x in range(start,end+1))\
$(&quot;%2d | %3d&quot; % (x,x*x))
$endfor\
</pre></div>
</div>
<p>Applying expander.py to a file with the content shown above gives the following
result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">x</span> <span class="o">|</span>  <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="o">---|------</span>
 <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>
 <span class="mi">1</span> <span class="o">|</span>   <span class="mi">1</span>
 <span class="mi">2</span> <span class="o">|</span>   <span class="mi">4</span>
 <span class="mi">3</span> <span class="o">|</span>   <span class="mi">9</span>
 <span class="mi">4</span> <span class="o">|</span>  <span class="mi">16</span>
 <span class="mi">5</span> <span class="o">|</span>  <span class="mi">25</span>
</pre></div>
</div>
<p>And here we show how pyexpander compares with the well known m4 macro
processor. We have taken the
<a class="reference external" href="http://en.wikipedia.org/wiki/M4_(computer_language)">m4</a> example with small
modifications from Wikipedia:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>divert(-1)
# This starts the count at ONE as the incr is a preincrement.
define(`H2_COUNT&#39;, 0)
# The H2_COUNT macro is redefined every time the H2 macro is used.
define(`H2&#39;,
        `define(`H2_COUNT&#39;, incr(H2_COUNT))&lt;h2&gt;H2_COUNT. $1&lt;/h2&gt;&#39;)
divert(0)dnl Diversion to 0 means back to normal. dnl macro removes this line.
H2(First Section)
H2(Second Section)
H2(Conclusion)
</pre></div>
</div>
<p>Here is the same example formulated in pyexpander:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$py(
# This starts the count at ONE as the incr is a preincrement.
H2_COUNT=0
# H2_COUNT is incremented each time H2 is called.
def H2(st):
    global H2_COUNT
    H2_COUNT+=1
    return &quot;&lt;h2&gt;%d. %s&lt;/h2&gt;&quot; % (H2_COUNT,st)
)\
$# the following makes H2 callable without another pair of enclosing brackets:
$extend(H2)\
$H2(&quot;First Section&quot;)
$H2(&quot;Second Section&quot;)
$H2(&quot;Conclusion&quot;)
</pre></div>
</div>
<p>Both produce this output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="mf">1.</span> <span class="n">First</span> <span class="n">Section</span><span class="o">&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="mf">2.</span> <span class="n">Second</span> <span class="n">Section</span><span class="o">&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="mf">3.</span> <span class="n">Conclusion</span><span class="o">&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The advantages of pyexpander are:</p>
<ul class="simple">
<li><p>simple syntax definition, all expander commands start with a dollar (“$”)
sign followed by word characters, parameters or python code enclosed in
brackets or both.</p></li>
<li><p>the full power of the python programming language can be used, all operators,
functions and modules.</p></li>
<li><p><em>any</em> python expression can be used to insert text.</p></li>
<li><p>There is also a python library, pyexpander.py, which you can use to develop
other macro tools based on pyexpander.</p></li>
</ul>
<p>If you are not familiar with the python programming language, you should have
a look at <a class="reference internal" href="python3.html"><span class="doc">python 3 introduction for pyexpander</span></a>.</p>
<p>For a detailed description of the pyexpander language see
<a class="reference internal" href="reference-expander.html"><span class="doc">reference</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="reference-expander.html" class="btn btn-neutral float-right" title="Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to pyexpander’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Helmholtz-Zentrum Berlin GmbH

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>